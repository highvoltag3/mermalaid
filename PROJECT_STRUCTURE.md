# Project Structure

This document explains the organization of the Mermalaid codebase.

## Overview

Mermalaid is a **dual-mode application**:
1. **Desktop App** - Native macOS app built with Tauri
2. **Web App** - Static web application deployed to Appwrite Sites

Both modes share the same frontend code (React + TypeScript), but are packaged differently.

## Directory Structure

```
mermalaid/
├── src/                      # Web app frontend (shared with desktop)
│   ├── components/           # React components
│   ├── contexts/             # React contexts (theme, etc.)
│   ├── utils/                # Utility functions
│   ├── App.tsx               # Main app component
│   ├── main.tsx              # React entry point
│   └── vite-env.d.ts         # Vite environment types
│
├── src-tauri/                # Desktop app backend (Tauri/Rust)
│   ├── src/                  # Rust source code
│   ├── icons/                 # App icons
│   ├── Cargo.toml            # Rust dependencies
│   └── tauri.conf.json        # Tauri configuration
│
├── public/                   # Static assets (web & desktop)
│   ├── _redirects            # SPA routing (web)
│   └── robots.txt            # SEO (web)
│
├── dist/                     # Build output (web)
│   └── [generated files]     # Created by `npm run build`
│
├── index.html                # HTML entry point (web & desktop)
├── vite.config.ts            # Vite build configuration
├── tsconfig.json             # TypeScript configuration
├── package.json              # Dependencies & scripts
│
├── .appwrite.json            # Appwrite Sites deployment config
├── .nvmrc                     # Node.js version
├── env.example               # Environment variables template
│
└── [Documentation files]     # README, DEPLOYMENT.md, etc.
```

## File Categories

### Web App Files (Root)
These files are needed for both web deployment and Tauri packaging:

- `index.html` - HTML entry point
- `vite.config.ts` - Vite build configuration
- `package.json` - Dependencies and scripts
- `tsconfig.json` - TypeScript configuration
- `src/` - React application code
- `public/` - Static assets

**Why at root?** Tauri expects the frontend at the project root. The web app and desktop app share the same codebase.

### Desktop App Files
- `src-tauri/` - Tauri backend (Rust)
- Tauri reads from `dist/` (generated by `npm run build`)

### Deployment Files
- `.appwrite.json` - Appwrite Sites configuration
- `.github/workflows/` - CI/CD workflows
- `DEPLOYMENT.md` - Deployment instructions
- `APPWRITE_SETUP.md` - Appwrite setup guide

### Documentation
- `README.md` - Project overview
- `CONTRIBUTING.md` - Contribution guidelines
- `PROJECT_STRUCTURE.md` - This file
- `STATIC_HOSTING.md` - Static hosting details
- `DEPLOYMENT.md` - Deployment methods

## Build Process

### Web Deployment
1. `npm run build` → builds `src/` → outputs to `dist/`
2. `dist/` is deployed to Appwrite Sites
3. Static files served directly

### Desktop App
1. `npm run tauri:build` → builds `src/` → outputs to `dist/`
2. Tauri packages `dist/` with Rust backend → creates `.app` and `.dmg`
3. Native desktop application

## Why This Structure?

**Standard Tauri Pattern:**
- Tauri projects conventionally have the frontend at root and backend in `src-tauri/`
- This allows the same codebase to power both web and desktop apps
- No code duplication between platforms

**Shared Codebase:**
- `src/` contains all React components used by both web and desktop
- `package.json` includes dependencies for both (web deps + `@tauri-apps/api`)
- Single source of truth for the UI

**Separation of Concerns:**
- Web app: Pure React, builds to `dist/`
- Desktop app: React + Tauri, reads from `dist/`, packages with Rust backend
- Deployment configs: Separate files for each platform

## Alternative Structure (Not Recommended)

We could reorganize into:
```
webapp/
  ├── src/
  ├── index.html
  └── vite.config.ts
desktop/
  └── src-tauri/
```

**But this would require:**
- Updating Tauri config to point to `webapp/dist`
- More complex build scripts
- Breaking from Tauri conventions
- No real benefit since code is shared

## Questions?

- **Q: Why not separate folders for web and desktop?**
  - A: They share 100% of the frontend code, so separation would just add complexity without benefit.

- **Q: Can I deploy only the web app?**
  - A: Yes! Just use `npm run build` and deploy `dist/`. The Tauri files won't interfere.

- **Q: Are Tauri files included in web deployment?**
  - A: No. Only `dist/` is deployed, which contains only the compiled web assets.
